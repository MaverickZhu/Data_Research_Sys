# æ¶ˆé˜²å•ä½å»ºç­‘æ•°æ®å…³è”ç³»ç»Ÿæ¶æ„è®¾è®¡

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®èƒŒæ™¯
æ¶ˆé˜²ç›‘ç£ç®¡ç†ç³»ç»Ÿï¼ˆxxj_shdwjbxxï¼‰å’Œæ¶ˆé˜²éšæ‚£å®‰å…¨æ’æŸ¥ç³»ç»Ÿï¼ˆxfaqpc_jzdwxxï¼‰ä¸­å­˜åœ¨åŒä¸€å•ä½çš„é‡å¤å½•å…¥é—®é¢˜ï¼Œéœ€è¦é€šè¿‡æ™ºèƒ½åŒ¹é…ç®—æ³•è¿›è¡Œæ•°æ®å…³è”æ•´åˆã€‚

### æ ¸å¿ƒç›®æ ‡
1. **ç²¾ç¡®åŒ¹é…**ï¼šåŸºäºå•ä½åç§°å’Œç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç è¿›è¡Œç²¾ç¡®å…³è”
2. **æ¨¡ç³ŠåŒ¹é…**ï¼šé€šè¿‡AIç®—æ³•å¯¹ç›¸ä¼¼å•ä½è¿›è¡Œæ™ºèƒ½åŒ¹é…è¯„åˆ†
3. **æ•°æ®æ•´åˆ**ï¼šä»¥å®‰å…¨æ’æŸ¥ç³»ç»Ÿä¸ºä¸»ï¼Œå…³è”æ˜¾ç¤ºç›‘ç£ç®¡ç†ç³»ç»Ÿä¿¡æ¯
4. **è¿›åº¦ç®¡ç†**ï¼šé€šè¿‡Webç•Œé¢å®æ—¶ç›‘æ§åŒ¹é…è¿›åº¦å’Œç»“æœ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æŠ€æœ¯æ ˆé€‰æ‹©
```
å‰ç«¯æŠ€æœ¯æ ˆï¼š
â”œâ”€â”€ HTML5/CSS3/JavaScript
â”œâ”€â”€ Bootstrap 5 (å“åº”å¼UIæ¡†æ¶)
â”œâ”€â”€ Chart.js (æ•°æ®å¯è§†åŒ–)
â””â”€â”€ DataTables (è¡¨æ ¼ç»„ä»¶)

åç«¯æŠ€æœ¯æ ˆï¼š
â”œâ”€â”€ Python 3.8+
â”œâ”€â”€ Flask (Webæ¡†æ¶)
â”œâ”€â”€ PyMongo (MongoDBé©±åŠ¨)
â”œâ”€â”€ Pandas (æ•°æ®å¤„ç†)
â”œâ”€â”€ Scikit-learn (æœºå™¨å­¦ä¹ )
â”œâ”€â”€ FuzzyWuzzy (å­—ç¬¦ä¸²ç›¸ä¼¼åº¦)
â””â”€â”€ Celery (å¼‚æ­¥ä»»åŠ¡å¤„ç†)

æ•°æ®å­˜å‚¨ï¼š
â”œâ”€â”€ MongoDB (ä¸»æ•°æ®åº“)
â””â”€â”€ Redis (ç¼“å­˜å’Œä»»åŠ¡é˜Ÿåˆ—)
```

### æ¨¡å—æ¶æ„
```
Data_Research_Sys/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ matching/              # æ•°æ®åŒ¹é…æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ exact_matcher.py   # ç²¾ç¡®åŒ¹é…ç®—æ³•
â”‚   â”‚   â”œâ”€â”€ fuzzy_matcher.py   # æ¨¡ç³ŠåŒ¹é…ç®—æ³•
â”‚   â”‚   â”œâ”€â”€ similarity_scorer.py # ç›¸ä¼¼åº¦è¯„åˆ†å¼•æ“
â”‚   â”‚   â””â”€â”€ match_processor.py # åŒ¹é…å¤„ç†å™¨
â”‚   â”œâ”€â”€ database/              # æ•°æ®åº“æ“ä½œæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ connection.py      # æ•°æ®åº“è¿æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ operations.py      # CRUDæ“ä½œ
â”‚   â”œâ”€â”€ web/                   # Webåº”ç”¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ app.py            # Flaskåº”ç”¨ä¸»ç¨‹åº
â”‚   â”‚   â”œâ”€â”€ routes.py         # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ static/           # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ templates/        # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ logger.py         # æ—¥å¿—ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.py         # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ helpers.py        # è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ main.py               # ç¨‹åºå…¥å£
â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database.yaml         # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ matching.yaml         # åŒ¹é…ç®—æ³•å‚æ•°
â”‚   â””â”€â”€ web.yaml             # WebæœåŠ¡é…ç½®
â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜
```

## ğŸ¯ æ•°æ®åŒ¹é…ç­–ç•¥

### å­—æ®µæ˜ å°„åˆ†æ
åŸºäºæ•°æ®å­—å…¸åˆ†æï¼Œç¡®å®šå…³é”®åŒ¹é…å­—æ®µï¼š

#### ç²¾ç¡®åŒ¹é…å­—æ®µ
```python
EXACT_MATCH_FIELDS = {
    'unit_name': {
        'source': 'xxj_shdwjbxx.dwmc',
        'target': 'xfaqpc_jzdwxx.UNIT_NAME'
    },
    'credit_code': {
        'source': 'xxj_shdwjbxx.tyshxydm', 
        'target': 'xfaqpc_jzdwxx.CREDIT_CODE'
    }
}
```

#### æ¨¡ç³ŠåŒ¹é…å­—æ®µæƒé‡é…ç½®
```python
FUZZY_MATCH_FIELDS = {
    'legal_person': {
        'source': 'xxj_shdwjbxx.fddbr',
        'target': 'xfaqpc_jzdwxx.LEGAL_PEOPLE',
        'weight': 0.25
    },
    'legal_tel': {
        'source': 'xxj_shdwjbxx.frlxdh',
        'target': 'xfaqpc_jzdwxx.LEGAL_TEL',
        'weight': 0.20
    },
    'security_manager': {
        'source': 'xxj_shdwjbxx.xfaqglr',
        'target': 'xfaqpc_jzdwxx.SECURITY_PEOPLE',
        'weight': 0.25
    },
    'building_area': {
        'source': 'xxj_shdwjbxx.jzmj',
        'target': 'xfaqpc_jzdwxx.BUILDING_SPACE',
        'weight': 0.15,
        'type': 'numeric'
    },
    'unit_address': {
        'source': 'xxj_shdwjbxx.dwdz',
        'target': None,  # ç›®æ ‡è¡¨æ— å¯¹åº”å­—æ®µ
        'weight': 0.15
    }
}
```

### åŒ¹é…ç®—æ³•è®¾è®¡

#### 1. ç²¾ç¡®åŒ¹é…ç®—æ³•
```python
class ExactMatcher:
    def match(self, source_record, target_records):
        """
        ç²¾ç¡®åŒ¹é…é€»è¾‘ï¼š
        1. å•ä½åç§°å®Œå…¨ä¸€è‡´
        2. ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ä¸€è‡´
        3. ä¼˜å…ˆçº§ï¼šä¿¡ç”¨ä»£ç  > å•ä½åç§°
        """
```

#### 2. æ¨¡ç³ŠåŒ¹é…ç®—æ³•
```python
class FuzzyMatcher:
    def __init__(self):
        self.threshold = 0.75  # ç›¸ä¼¼åº¦é˜ˆå€¼
        
    def calculate_similarity(self, source_record, target_record):
        """
        å¤šç»´åº¦ç›¸ä¼¼åº¦è®¡ç®—ï¼š
        1. å­—ç¬¦ä¸²ç›¸ä¼¼åº¦ï¼ˆç¼–è¾‘è·ç¦»ã€éŸ³å½¢ç ï¼‰
        2. æ•°å€¼ç›¸ä¼¼åº¦ï¼ˆå»ºç­‘é¢ç§¯ç­‰ï¼‰
        3. åŠ æƒç»¼åˆè¯„åˆ†
        """
```

#### 3. AIå¢å¼ºåŒ¹é…
```python
class AIEnhancedMatcher:
    def __init__(self):
        self.vectorizer = TfidfVectorizer()
        self.similarity_model = None
        
    def train_model(self, training_data):
        """
        è®­ç»ƒæ–‡æœ¬ç›¸ä¼¼åº¦æ¨¡å‹ï¼š
        1. TF-IDFå‘é‡åŒ–
        2. ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
        3. æœºå™¨å­¦ä¹ åˆ†ç±»å™¨
        """
```

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### ç»“æœè¡¨ç»“æ„è®¾è®¡
```python
# åŒ¹é…ç»“æœè¡¨ (match_results)
{
    "_id": ObjectId,
    "primary_unit_id": "xfaqpcè¡¨çš„ID",
    "primary_unit_name": "å®‰å…¨æ’æŸ¥ç³»ç»Ÿå•ä½åç§°",
    "matched_unit_id": "xxjè¡¨çš„IDï¼ˆå¦‚æœåŒ¹é…æˆåŠŸï¼‰",
    "matched_unit_name": "æ¶ˆé˜²ç›‘ç£ç³»ç»Ÿå•ä½åç§°ï¼ˆå¦‚æœåŒ¹é…æˆåŠŸï¼‰",
    "combined_unit_name": "ä¸»å•ä½åç§°ï¼ˆå…³è”å•ä½åç§°ï¼‰",
    "match_type": "exact|fuzzy|none",
    "similarity_score": 0.95,
    "match_details": {
        "credit_code_match": True,
        "name_similarity": 0.90,
        "legal_person_similarity": 0.85,
        "tel_similarity": 1.0,
        "address_similarity": 0.70
    },
    "status": "matched|unmatched|reviewed",
    "created_time": ISODate,
    "updated_time": ISODate,
    "processed_by": "system|manual"
}
```

## ğŸŒ Webç•Œé¢è®¾è®¡

### é¡µé¢ç»“æ„
1. **é¦–é¡µä»ªè¡¨æ¿**
   - åŒ¹é…è¿›åº¦ç»Ÿè®¡
   - åŒ¹é…ç»“æœæ¦‚è§ˆ
   - å®æ—¶å¤„ç†çŠ¶æ€

2. **åŒ¹é…ç®¡ç†é¡µé¢**
   - å¯åŠ¨/åœæ­¢åŒ¹é…ä»»åŠ¡
   - å‚æ•°é…ç½®
   - æ‰¹é‡å¤„ç†æ§åˆ¶

3. **ç»“æœæŸ¥çœ‹é¡µé¢**
   - åŒ¹é…ç»“æœåˆ—è¡¨
   - è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹
   - æ‰‹åŠ¨å®¡æ ¸åŠŸèƒ½

4. **æ•°æ®ç»Ÿè®¡é¡µé¢**
   - åŒ¹é…æˆåŠŸç‡åˆ†æ
   - ç›¸ä¼¼åº¦åˆ†å¸ƒå›¾è¡¨
   - å¼‚å¸¸æ•°æ®æŠ¥å‘Š

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ•°æ®åº“ä¼˜åŒ–
```python
# MongoDBç´¢å¼•è®¾è®¡
{
    "xxj_shdwjbxx": [
        {"dwmc": 1},           # å•ä½åç§°ç´¢å¼•
        {"tyshxydm": 1},       # ä¿¡ç”¨ä»£ç ç´¢å¼•
        {"fddbr": 1},          # æ³•äººç´¢å¼•
        {"dwmc": "text"}       # å…¨æ–‡æœç´¢ç´¢å¼•
    ],
    "xfaqpc_jzdwxx": [
        {"UNIT_NAME": 1},
        {"CREDIT_CODE": 1},
        {"LEGAL_PEOPLE": 1},
        {"UNIT_NAME": "text"}
    ]
}
```

### 2. æ‰¹å¤„ç†ç­–ç•¥
```python
class BatchProcessor:
    def __init__(self, batch_size=100):
        self.batch_size = batch_size
        
    def process_in_batches(self, data):
        """
        åˆ†æ‰¹å¤„ç†ç­–ç•¥ï¼š
        1. æ¯æ‰¹å¤„ç†100æ¡è®°å½•
        2. å¼‚æ­¥ä»»åŠ¡å¤„ç†
        3. è¿›åº¦å®æ—¶æ›´æ–°
        4. é”™è¯¯æ¢å¤æœºåˆ¶
        """
```

### 3. ç¼“å­˜ç­–ç•¥
```python
# Redisç¼“å­˜é…ç½®
CACHE_CONFIG = {
    'processed_units': 3600,      # å·²å¤„ç†å•ä½ç¼“å­˜1å°æ—¶
    'similarity_results': 1800,   # ç›¸ä¼¼åº¦ç»“æœç¼“å­˜30åˆ†é’Ÿ
    'match_progress': 60          # åŒ¹é…è¿›åº¦ç¼“å­˜1åˆ†é’Ÿ
}
```

## ğŸ”’ ç³»ç»Ÿå®‰å…¨ä¸ç›‘æ§

### 1. æ•°æ®å®‰å…¨
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- æ“ä½œæ—¥å¿—å®Œæ•´è®°å½•
- ç”¨æˆ·æƒé™æ§åˆ¶

### 2. ç³»ç»Ÿç›‘æ§
- å®æ—¶æ€§èƒ½ç›‘æ§
- å¼‚å¸¸é”™è¯¯æŠ¥è­¦
- æ•°æ®è´¨é‡æ£€æŸ¥

### 3. å®¹é”™æœºåˆ¶
- æ–­ç‚¹ç»­å¤„ç†
- æ•°æ®å¤‡ä»½æ¢å¤
- å¼‚å¸¸æƒ…å†µå›æ»š

## ğŸ“ˆ éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ
```yaml
Development:
  Database: MongoDB 4.4+
  Cache: Redis 6.0+
  Python: 3.8+
  Web Server: Flask Development Server
```

### ç”Ÿäº§ç¯å¢ƒ
```yaml
Production:
  Database: MongoDB Atlas/è‡ªå»ºé›†ç¾¤
  Cache: Redis Cluster
  Web Server: Gunicorn + Nginx
  Task Queue: Celery + Redis
  Monitoring: Prometheus + Grafana
```

## ğŸš€ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼ˆåŸºç¡€æ¡†æ¶ï¼‰
- [ ] é¡¹ç›®æ¶æ„æ­å»º
- [ ] æ•°æ®åº“è¿æ¥å’Œæ¨¡å‹è®¾è®¡
- [ ] åŸºç¡€Webæ¡†æ¶æ­å»º

### ç¬¬äºŒé˜¶æ®µï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- [ ] ç²¾ç¡®åŒ¹é…ç®—æ³•å®ç°
- [ ] æ¨¡ç³ŠåŒ¹é…ç®—æ³•å®ç°
- [ ] æ‰¹å¤„ç†å¼•æ“å¼€å‘

### ç¬¬ä¸‰é˜¶æ®µï¼ˆç•Œé¢å¼€å‘ï¼‰
- [ ] Webç•Œé¢è®¾è®¡å®ç°
- [ ] æ•°æ®å¯è§†åŒ–åŠŸèƒ½
- [ ] ç”¨æˆ·äº¤äº’ä¼˜åŒ–

### ç¬¬å››é˜¶æ®µï¼ˆæµ‹è¯•ä¼˜åŒ–ï¼‰
- [ ] ç³»ç»Ÿæµ‹è¯•å’Œæ€§èƒ½è°ƒä¼˜
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

---

**è®¾è®¡åŸåˆ™éµå¾ªï¼š**
- âœ… ç¬¬ä¸€æ€§åŸç†ï¼šä»æ ¹æœ¬ä¸šåŠ¡éœ€æ±‚å‡ºå‘
- âœ… KISSåŸåˆ™ï¼šä¿æŒç³»ç»Ÿç®€æ´é«˜æ•ˆ
- âœ… SOLIDåŸåˆ™ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºç»´æŠ¤
- âœ… å•ä¸€èŒè´£ï¼šæ¯ä¸ªæ¨¡å—èŒè´£æ¸…æ™°
- âœ… ä»£ç å¤ç”¨ï¼šé¿å…é‡å¤å¼€å‘